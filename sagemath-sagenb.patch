diff -up build/pkgs/sagenb/src/sagenb-0.10.8.2/flask_version/base.py.orig build/pkgs/sagenb/src/sagenb-0.10.8.2/flask_version/base.py
--- build/pkgs/sagenb/src/sagenb-0.10.8.2/flask_version/base.py.orig	2014-02-11 18:13:34.453086409 -0200
+++ build/pkgs/sagenb/src/sagenb-0.10.8.2/flask_version/base.py	2014-02-11 18:14:30.976088573 -0200
@@ -4,8 +4,6 @@ from functools import partial
 from flask import Flask, Module, url_for, render_template, request, session, redirect, g, make_response, current_app
 from decorators import login_required, guest_or_login_required, with_lock
 from decorators import global_lock
-# Make flask use the old session foo from <=flask-0.9
-from flask_oldsessions import OldSecureCookieSessionInterface
 
 from flask.ext.autoindex import AutoIndex
 try:
@@ -25,7 +23,6 @@ class SageNBFlask(Flask):
     def __init__(self, *args, **kwds):
         self.startup_token = kwds.pop('startup_token', None)
         Flask.__init__(self, *args, **kwds)
-        self.session_interface = OldSecureCookieSessionInterface()
 
         self.config['SESSION_COOKIE_HTTPONLY'] = False
 
@@ -36,7 +33,7 @@ class SageNBFlask(Flask):
         self.add_static_path('/javascript', DATA)
         self.add_static_path('/static', DATA)
         self.add_static_path('/java', DATA)
-        self.add_static_path('/java/jmol', os.path.join(os.environ["SAGE_ROOT"],"local","share","jmol"))
+        self.add_static_path('/java/jmol', os.path.join(DATA, "jmol"))
         import mimetypes
         mimetypes.add_type('text/plain','.jmol')
 
diff -up build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/html/notebook/base.html.orig build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/html/notebook/base.html
--- build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/html/notebook/base.html.orig	2014-02-11 18:13:34.468086409 -0200
+++ build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/html/notebook/base.html	2014-02-11 18:13:51.591087065 -0200
@@ -46,7 +46,7 @@ INPUT:
 <!-- Jmol - embedded 3D graphics -->
 <script type="text/javascript" src="/java/jmol/appletweb/Jmol.js"></script>
 <!-- This must stay in head -->
-<script>jmolInitialize("/java/jmol");jmolSetCallback("menuFile","/java/jmol/appletweb/SageMenu.mnu");</script>
+<script>jmolInitialize("/java/jmol", "JmolApplet.jar,Jmol.jar,vecmath.jar");</script>
 
 {% if JEDITABLE_TINYMCE and not worksheet.docbrowser() and not worksheet.is_published() %}
 <!-- TinyMCE and jEditable - in-place editing of text cells -->
diff -up build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/js/jmol_lib.js.orig build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/js/jmol_lib.js
--- build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/js/jmol_lib.js.orig	2014-02-11 18:13:34.422086407 -0200
+++ build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/data/sage/js/jmol_lib.js	2014-02-11 18:13:51.576087064 -0200
@@ -256,9 +256,6 @@ function makeCntrlPanels(url, n, functio
     panelHTML +='<button title="Move to own window" onClick="javascript:void(jmol_popup(\''+n+'\'))">Move to own window</button> arbitrarily resizable.<hr/>';
     //static image to save
     panelHTML +='<button onClick="sleepJmol('+n+',jmolStatus)"> Get Static Image to Save (Sleep) </button> Right-click or Cmd-click on image to get download options.<hr/>';
-    //save file to local disk
-    panelHTML += '<button title="Download View" onClick="javascript:void(jmolFileDownload('+n+'))">Download this view</button> will require loading signed applet if not already done.';
-    panelHTML +='<hr/>';
     //spin on
     panelHTML +='<input class="worksheet" type="checkbox" value="spin on" onchange="jmol_spin(this.checked,'+n+');" title="Enable/disable spin"/>Spin on';
     //antialaisdisplay (smoothing of objects)
diff -up build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/flask_version/base.py.orig build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/flask_version/base.py
--- build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/flask_version/base.py.orig	2014-02-11 18:13:34.459086409 -0200
+++ build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/flask_version/base.py	2014-02-11 18:13:51.590087065 -0200
@@ -4,8 +4,6 @@ from functools import partial
 from flask import Flask, Module, url_for, render_template, request, session, redirect, g, make_response, current_app
 from decorators import login_required, guest_or_login_required, with_lock
 from decorators import global_lock
-# Make flask use the old session foo from <=flask-0.9
-from flask_oldsessions import OldSecureCookieSessionInterface
 
 from flask.ext.autoindex import AutoIndex
 try:
@@ -25,7 +23,6 @@ class SageNBFlask(Flask):
     def __init__(self, *args, **kwds):
         self.startup_token = kwds.pop('startup_token', None)
         Flask.__init__(self, *args, **kwds)
-        self.session_interface = OldSecureCookieSessionInterface()
 
         self.config['SESSION_COOKIE_HTTPONLY'] = False
 
@@ -36,7 +33,7 @@ class SageNBFlask(Flask):
         self.add_static_path('/javascript', DATA)
         self.add_static_path('/static', DATA)
         self.add_static_path('/java', DATA)
-        self.add_static_path('/java/jmol', os.path.join(os.environ["SAGE_ROOT"],"local","share","jmol"))
+        self.add_static_path('/java/jmol', os.path.join(DATA, "jmol"))
         import mimetypes
         mimetypes.add_type('text/plain','.jmol')
 
diff -up build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/cell.py.orig build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/cell.py
--- build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/cell.py.orig	2014-02-11 18:13:34.441086408 -0200
+++ build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/cell.py	2014-02-11 18:13:51.583087065 -0200
@@ -2369,7 +2369,7 @@ class Cell(Cell_generic):
                     jmol_script = jmol_file.read()
                     jmol_file.close()
 
-                    jmol_script = jmol_script.replace('defaultdirectory "', 'defaultdirectory "' + self.url_to_self() + '/')
+                    jmol_script = jmol_script.replace('defaultdirectory "', 'defaultdirectory "/home/' + self.worksheet_filename() + '/')
 
                     jmol_file = open(jmol_name, 'w')
                     jmol_file.write(jmol_script)
diff -up build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/run_notebook.py.orig build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/run_notebook.py
--- build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/run_notebook.py.orig	2014-02-11 18:13:34.447086408 -0200
+++ build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/notebook/run_notebook.py	2014-02-11 18:13:51.586087065 -0200
@@ -46,12 +46,14 @@ sagenb.notebook.misc.DIR = %(cwd)r #We s
 # Flask #
 #########
 import os, sys, random
-import sagenb.flask_version.base as flask_base
+sagenb_dir = os.path.join(os.environ['SAGE_ROOT'], 'src', 'sagenb')
+sys.path.append(sagenb_dir)
+import flask_version.base as flask_base
 opts={}
 startup_token = '{0:x}'.format(random.randint(0, 2**128))
 if %(automatic_login)s:
     opts['startup_token'] = startup_token
-flask_app = flask_base.create_app(%(notebook_opts)s, **opts)
+flask_app = flask_base.create_app(%(notebook_opts)s, startup_token=startup_token)
 
 def save_notebook(notebook):
     print "Quitting all running worksheets..."
--- build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/misc/misc.py.orig	2014-02-19 12:22:25.360997774 -0300
+++ build/pkgs/sagenb/src/sagenb-0.10.8.2/sagenb/misc/misc.py	2014-02-19 12:26:01.260011849 -0300
@@ -174,7 +174,8 @@ def pad_zeros(s, size=3):
 
 SAGENB_ROOT = os.path.split(resource_filename(__name__, ''))[0]
 
-DATA = os.path.join(SAGENB_ROOT, 'data')
+from sage.misc.misc import SAGE_SRC
+DATA = os.path.join(SAGE_SRC, 'sagenb', 'data')
 
 if os.environ.has_key('DOT_SAGENB'):
     DOT_SAGENB = os.environ['DOT_SAGENB']
