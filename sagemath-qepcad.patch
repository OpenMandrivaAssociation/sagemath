--- sage-5.4.1/spkg/build/sage-5.4.1/sage/interfaces/qepcad.py.orig	2012-12-12 16:17:49.998963475 -0200
+++ sage-5.4.1/spkg/build/sage-5.4.1/sage/interfaces/qepcad.py	2012-12-12 16:19:56.477245633 -0200
@@ -540,6 +540,8 @@ from sage.misc.preparser import implicit
 
 from expect import Expect, ExpectFunction, AsciiArtString
 
+QEPCAD_LOCAL = "/usr/share/qepcad"
+
 def _qepcad_cmd(memcells=None):
     r"""
     Construct a QEPCAD command line.  Optionally set the
@@ -560,7 +562,7 @@ def _qepcad_cmd(memcells=None):
         memcells_arg = '+N%s' % memcells
     else:
         memcells_arg = ''
-    return "env qe=%s qepcad %s"%(sage.misc.misc.SAGE_LOCAL, memcells_arg)
+    return "env qe=%s qepcad %s"%(QEPCAD_LOCAL, memcells_arg)
 
 _command_info_cache = None
 
@@ -582,7 +584,7 @@ def _update_command_info():
 
     cache = {}
 
-    with open('%s/bin/qepcad.help'%sage.misc.misc.SAGE_LOCAL) as help:
+    with open('%s/bin/qepcad.help'%QEPCAD_LOCAL) as help:
         assert(help.readline().strip() == '@')
 
         while True:
@@ -630,23 +632,22 @@ def _update_command_info():
 
     _command_info_cache = cache
             
-_rewrote_qepcadrc = False
+_rewrote_qepcadrc = True        # don't rewrite a system file
 def _rewrite_qepcadrc():
     r"""
     Write the file \file{default.qepcadrc} to specify a path to Singular
     (which QEPCAD uses for Gr\"obner basis computations).
 
     EXAMPLES:
-        sage: from sage.interfaces.qepcad import _rewrite_qepcadrc
+        sage: from sage.interfaces.qepcad import _rewrite_qepcadrc, QEPCAD_LOCAL
         sage: _rewrite_qepcadrc()
-        sage: from sage.misc.misc import SAGE_LOCAL
-        sage: open('%s/default.qepcadrc'%SAGE_LOCAL).readlines()[-1]
-        'SINGULAR .../bin'
+        sage: open('%s/default.qepcadrc'%QEPCAD_LOCAL).readlines()[-1]
+        'SINGULAR /usr/bin'
     """
     global _rewrote_qepcadrc
     if _rewrote_qepcadrc: return
 
-    SL = sage.misc.misc.SAGE_LOCAL
+    SL = QEPCAD_LOCAL
     fn = '%s/default.qepcadrc'%SL
     text = \
 """# THIS FILE IS AUTOMATICALLY GENERATED -- DO NOT EDIT
@@ -658,7 +659,7 @@ def _rewrite_qepcadrc():
 # so that it gets used for some computer algebra
 # computations is the only feature.
 #####################################################
-SINGULAR %s/bin""" % SL
+SINGULAR /usr/bin"""
 
     open(fn, 'w').write(text)
 
